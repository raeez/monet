#!/bin/bash

if [ `whoami` == root ]; then
	echo Please DONT run this script as root, or using sudo
	exit
fi

echo ""
echo "****************************************"
echo "* Setting up memoize-dev environment *"
echo "****************************************"
echo ""

# system and python dependencies
sudo port install python27 \
			 python_select \
			 py27-setuptools \

# ensure python27 is the active python
sudo python_select python27

sudo port install git-core +svn \
			 mongodb +python27 \

sudo port install vim +python27 \
			 MacVim +python27 \

# dev env
sudo /opt/local/Library/Frameworks/Python.framework/Versions/2.7/bin/easy_install pip
sudo /opt/local/Library/Frameworks/Python.framework/Versions/2.7/bin/pip install virtualenv
/opt/local/Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenv -p python2.7 --no-site-packages --distribute --clear env
. env/bin/activate

# python dependencies
pip install Flask \
                PIL \
                sphinx \
                ipython \
                pymongo \
                pyflakes \
                py-bcrypt \
                flask-uploads \
                flask-celery \

ln -s $(pwd) env/lib/python2.7/site-packages/memoize

git clone git://fabfile.org/fabric.git fabric
cd fabric
python setup.py build
python setup.py install

echo ""
echo "************************"
echo "* memoize-dev::Done! *"
echo "************************"
echo ""
